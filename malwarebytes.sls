# Source: http://www.malwarebytes.org
# This is a terrible setup, as Malwarebytes give you a single installer with no version information, nor do they release previous versions to
# download from their official site. 
# Use this with caution.
malwarebytes:
  {% for version in ['4.3.0.210'] %}
  # just 32-bit x86 installer available
  {% if grains['cpuarch'] == 'AMD64' %}
      {% set PROGRAM_FILES = "%ProgramFiles(x86)%" %}
  {% else %}
      {% set PROGRAM_FILES = "%ProgramFiles%" %}
  {% endif %}
  '{{ version }}':
    full_name: 'Malwarebytes Anti-Malware version {{ version }}'
    installer: 'https://data-cdn.mbamupdates.com/web/mb4-setup-consumer/MBSetup.exe'
    install_flags: '/SP- /VERYSILENT /SUPPRESSMSGBOXES /NORESTART'
    uninstaller: '{{ PROGRAM_FILES }}\Malwarebytes Anti-Malware\unins000.exe'
    uninstall_flags: '/SP- /VERYSILENT /SUPPRESSMSGBOXES /NORESTART'
    msiexec: False
    locale: en_US
    reboot: False
  {% endfor %}

  {% for version in ['4.5.12.204'] %}
  {% set PROGRAM_FILES = "%ProgramFiles%" %}
  '{{ version }}':
    full_name: 'Malwarebytes version {{ version }}'
    installer: 'https://data-cdn.mbamupdates.com/web/mb4-setup-consumer/MBSetup.exe'
    install_flags: '/SP- /VERYSILENT /NORESTART'
    uninstaller: '{{ PROGRAM_FILES }}\Malwarebytes\Anti-Malware\mbuns.exe'
    uninstall_flags: '/VERYSILENT /NORESTART'
    msiexec: False
    locale: en_US
    reboot: False
  {% endfor %}

